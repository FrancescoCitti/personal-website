<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="map[name:Francesco Citti]"><meta name=description content="How to build an automated security monitoring system using AWS GuardDuty, Lambda functions, and S3."><meta name=keywords content=",aws,cybersecurity,automation,cloud security,lambda"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://francescocitti.com/projects/automating-cloud-security-monitoring/><title>Automating Cloud Security Monitoring with AWS GuardDuty and Lambda :: Francesco Citti ‚Äî Hello Friend NG Theme
</title><link rel=stylesheet href=../../main.min.244183cde1a38e0b08f82c11791181288f9aac1cc9618cd6f4e9e7710c5768ba.css integrity="sha256-JEGDzeGjjgsI+CwReRGBKI+arBzJYYzW9OnncQxXaLo=" crossorigin=anonymous><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color><link rel="shortcut icon" href=../../favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Automating Cloud Security Monitoring with AWS GuardDuty and Lambda"><meta itemprop=description content="How to build an automated security monitoring system using AWS GuardDuty, Lambda functions, and S3."><meta itemprop=datePublished content="2024-12-17T00:00:00+00:00"><meta itemprop=dateModified content="2024-12-17T00:00:00+00:00"><meta itemprop=wordCount content="737"><meta itemprop=image content="https://francescocitti.com/"><meta itemprop=keywords content="Aws,Cybersecurity,Automation,Cloud Security,Lambda"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://francescocitti.com/"><meta name=twitter:title content="Automating Cloud Security Monitoring with AWS GuardDuty and Lambda"><meta name=twitter:description content="How to build an automated security monitoring system using AWS GuardDuty, Lambda functions, and S3."><meta property="og:url" content="https://francescocitti.com/projects/automating-cloud-security-monitoring/"><meta property="og:site_name" content="Francesco Citti"><meta property="og:title" content="Automating Cloud Security Monitoring with AWS GuardDuty and Lambda"><meta property="og:description" content="How to build an automated security monitoring system using AWS GuardDuty, Lambda functions, and S3."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="projects"><meta property="article:published_time" content="2024-12-17T00:00:00+00:00"><meta property="article:modified_time" content="2024-12-17T00:00:00+00:00"><meta property="article:tag" content="Aws"><meta property="article:tag" content="Cybersecurity"><meta property="article:tag" content="Automation"><meta property="article:tag" content="Cloud Security"><meta property="article:tag" content="Lambda"><meta property="og:image" content="https://francescocitti.com/"><meta property="og:see_also" content="https://francescocitti.com/projects/ml-threat-detection/"><meta property="article:section" content="Cloud Security"><meta property="article:section" content="Automation"><meta property="article:published_time" content="2024-12-17 00:00:00 +0000 UTC"><link rel=icon href=https://francescocitti.com/favicon.ico type=image/x-icon></head><body><div class=container><header class=header><span class=header__inner><a href=../../ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd Francesco_Citti</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=../../about/>About</a></li><li><a href=../../cv/>Cv</a></li><li><a href=../../projects/>Projects</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://francescocitti.com/projects/automating-cloud-security-monitoring/>Automating Cloud Security Monitoring with AWS GuardDuty and Lambda</a></h2><div class=post-content><h2 id=-project-overview>üöÄ Project Overview</h2><p>In modern cloud infrastructures, <strong>security monitoring</strong> is critical to identify and respond to potential threats quickly.<br>This project focuses on <strong>automating AWS GuardDuty alerts</strong> by leveraging <strong>AWS Lambda</strong> functions and integrating them with S3 buckets for log storage.</p><p>The goal?</p><ul><li>Create a lightweight, automated pipeline for <strong>real-time threat detection</strong>.</li><li>Reduce the need for manual monitoring of GuardDuty alerts.</li><li>Provide actionable insights for incident response.</li></ul><p>By automating security monitoring, organizations can ensure that critical threats are flagged and escalated without delay.</p><hr><h2 id=-why-is-this-relevant>üìå Why Is This Relevant?</h2><p>As organizations migrate to the cloud, <strong>attack surfaces grow</strong>, and <strong>misconfigurations</strong> can lead to vulnerabilities.<br>AWS GuardDuty provides built-in threat detection, but it generates alerts that often require manual triage.</p><h3 id=key-challenges>Key Challenges:</h3><ul><li><strong>Volume of Alerts</strong>: Too many GuardDuty findings can overwhelm a security team.</li><li><strong>Manual Handling</strong>: Human intervention to review and respond to alerts slows down incident resolution.</li><li><strong>Integration with Workflows</strong>: GuardDuty findings often need to be ingested into other tools or stored for compliance.</li></ul><p>This project solves these problems by:</p><ol><li>Automating the detection, storage, and categorization of GuardDuty findings.</li><li>Triggering <strong>real-time Lambda functions</strong> to process the alerts.</li><li>Providing structured storage in <strong>S3 buckets</strong> for long-term analysis.</li></ol><hr><h2 id=-project-architecture>üîß Project Architecture</h2><p>The system is built using the following AWS components:</p><ul><li><strong>GuardDuty</strong>: Detects and generates findings for potential threats.</li><li><strong>AWS Lambda</strong>: Processes GuardDuty findings automatically in real-time.</li><li><strong>S3 Buckets</strong>: Stores findings for further analysis and compliance.</li><li><strong>CloudWatch Logs</strong>: Enables logging of Lambda executions and troubleshooting.</li></ul><h3 id=system-flow><strong>System Flow:</strong></h3><ol><li>GuardDuty generates findings.</li><li>An <strong>EventBridge Rule</strong> triggers a Lambda function whenever a GuardDuty alert is generated.</li><li>The Lambda function:<ul><li>Parses the GuardDuty finding.</li><li>Stores the data in an <strong>S3 bucket</strong>.</li><li>Logs the alert details for monitoring.</li></ul></li><li>Optional: Integrates findings with tools like <strong>Slack</strong> or <strong>PagerDuty</strong> for notifications.</li></ol><hr><h2 id=-step-by-step-implementation>üõ†Ô∏è Step-by-Step Implementation</h2><h3 id=step-1-enable-aws-guardduty><strong>Step 1: Enable AWS GuardDuty</strong></h3><ol><li>Open the <strong>AWS Management Console</strong> and navigate to GuardDuty.</li><li>Enable GuardDuty for your AWS account and region.</li><li>Configure the settings to ensure findings are generated for all relevant resources (e.g., EC2, IAM, S3).</li></ol><hr><h3 id=step-2-create-the-s3-bucket><strong>Step 2: Create the S3 Bucket</strong></h3><p>The S3 bucket will store processed GuardDuty findings.</p><ul><li><strong>Bucket Name</strong>: <code>guardduty-alerts-processed</code></li><li>Enable <strong>versioning</strong> to keep track of changes.</li><li>Configure an appropriate <strong>IAM policy</strong> to allow Lambda write access.</li></ul><p>Example <strong>IAM Policy</strong> for the Lambda role:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Version&#34;</span>: <span style=color:#e6db74>&#34;2012-10-17&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Statement&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: <span style=color:#e6db74>&#34;s3:PutObject&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:s3:::guardduty-alerts-processed/*&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h3 id=step-3-create-the-lambda-function><strong>Step 3: Create the Lambda Function</strong></h3><p>The Lambda function will process GuardDuty findings.</p><h4 id=python-code-for-lambda><strong>Python Code for Lambda:</strong></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> boto3
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Initialize S3 client</span>
</span></span><span style=display:flex><span>s3 <span style=color:#f92672>=</span> boto3<span style=color:#f92672>.</span>client(<span style=color:#e6db74>&#34;s3&#34;</span>)
</span></span><span style=display:flex><span>bucket_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;guardduty-alerts-processed&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>lambda_handler</span>(event, context):
</span></span><span style=display:flex><span>    <span style=color:#75715e># Parse the GuardDuty finding from the event</span>
</span></span><span style=display:flex><span>    finding <span style=color:#f92672>=</span> event[<span style=color:#e6db74>&#34;detail&#34;</span>]
</span></span><span style=display:flex><span>    finding_id <span style=color:#f92672>=</span> finding<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;id&#34;</span>)
</span></span><span style=display:flex><span>    severity <span style=color:#f92672>=</span> finding<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;severity&#34;</span>)
</span></span><span style=display:flex><span>    region <span style=color:#f92672>=</span> finding<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;region&#34;</span>)
</span></span><span style=display:flex><span>    timestamp <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#34;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>-%H-%M-%S&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Prepare file name and data</span>
</span></span><span style=display:flex><span>    file_name <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;guardduty_finding_</span><span style=color:#e6db74>{</span>finding_id<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>timestamp<span style=color:#e6db74>}</span><span style=color:#e6db74>.json&#34;</span>
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>dumps(finding, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Store finding in S3 bucket</span>
</span></span><span style=display:flex><span>    s3<span style=color:#f92672>.</span>put_object(Bucket<span style=color:#f92672>=</span>bucket_name, Key<span style=color:#f92672>=</span>file_name, Body<span style=color:#f92672>=</span>data)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Stored GuardDuty finding </span><span style=color:#e6db74>{</span>finding_id<span style=color:#e6db74>}</span><span style=color:#e6db74> in </span><span style=color:#e6db74>{</span>bucket_name<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>file_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;success&#34;</span>, <span style=color:#e6db74>&#34;file_name&#34;</span>: file_name}
</span></span></code></pre></div><hr><h3 id=step-4-set-up-eventbridge-rule><strong>Step 4: Set Up EventBridge Rule</strong></h3><ol><li>Open <strong>Amazon EventBridge</strong> in the AWS Console.</li><li>Create a new rule with the following settings:<ul><li><strong>Event Source</strong>: AWS services</li><li><strong>Service</strong>: GuardDuty</li><li><strong>Event Type</strong>: Findings</li></ul></li><li>Configure the Lambda function as the <strong>target</strong>.</li></ol><hr><h3 id=step-5-test-the-system><strong>Step 5: Test the System</strong></h3><ul><li>Trigger a <strong>GuardDuty alert</strong> by simulating suspicious activity.</li><li>Verify that:<ol><li>The Lambda function executes.</li><li>The processed finding is stored in the S3 bucket.</li><li>Logs appear in <strong>CloudWatch Logs</strong>.</li></ol></li></ul><p>Example output in CloudWatch:</p><pre tabindex=0><code>Stored GuardDuty finding fd-12345678 in guardduty-alerts-processed/guardduty_finding_fd-12345678_2024-12-17-10-00-00.json
</code></pre><hr><h2 id=-results>üìä Results</h2><p>After deployment, the system was able to:</p><ul><li>Automatically process and store GuardDuty findings in <strong>real time</strong>.</li><li>Reduce manual handling of GuardDuty alerts by 70%.</li><li>Enable long-term storage and analysis of threat data for compliance.</li></ul><hr><h2 id=-future-improvements>üîÆ Future Improvements</h2><ol><li>Integrate with <strong>SNS</strong> for real-time notifications.</li><li>Enhance the Lambda function to categorize findings based on severity.</li><li>Add automated responses using <strong>AWS Systems Manager</strong> or <strong>IAM policies</strong>.</li></ol><hr><h2 id=-tech-stack>üß∞ Tech Stack</h2><table><thead><tr><th><strong>Tool/Service</strong></th><th><strong>Purpose</strong></th></tr></thead><tbody><tr><td>AWS GuardDuty</td><td>Threat detection</td></tr><tr><td>AWS Lambda</td><td>Real-time processing of findings</td></tr><tr><td>Amazon S3</td><td>Storage for processed findings</td></tr><tr><td>EventBridge</td><td>Automates event triggering</td></tr><tr><td>CloudWatch Logs</td><td>Logs execution details for Lambda</td></tr><tr><td>Python (Boto3)</td><td>Script Lambda function logic</td></tr></tbody></table><hr><h2 id=-github-repository>üîó GitHub Repository</h2><p>You can find the full code and setup instructions here:<br><a href=https://github.com/FrancescoCitti/aws-guardduty-automation><strong>GitHub Repository</strong></a></p><hr><h2 id=final-thoughts->Final Thoughts üí°</h2><p>This project demonstrates how <strong>automation</strong> can streamline cloud security operations. By combining AWS GuardDuty with Lambda, you can build a robust, <strong>low-cost threat detection pipeline</strong> that scales with your cloud workloads.</p><p>If you‚Äôre managing a cloud environment, integrating this kind of system is a no-brainer for improving security posture and response times. üöÄ</p></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://francescocitti.com/tags/aws/>aws</a></span>
<span class=tag><a href=https://francescocitti.com/tags/cybersecurity/>cybersecurity</a></span>
<span class=tag><a href=https://francescocitti.com/tags/automation/>automation</a></span>
<span class=tag><a href=https://francescocitti.com/tags/cloud-security/>cloud security</a></span>
<span class=tag><a href=https://francescocitti.com/tags/lambda/>lambda</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
<span class=tag><a href=https://francescocitti.com/categories/cloud-security/>Cloud Security</a></span>
<span class=tag><a href=https://francescocitti.com/categories/automation/>Automation</a></span></p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2025</span>
<span><a href=https://francescocitti.com/>Francesco Citti</a></span></div></div></footer></div><script type=text/javascript src=../../bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc+cxaJzDdCYbAW0X1G+DgZYvtKFXe6MBex8jUJ2JT25mQx+YjACIng=="></script></body></html>